<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Leo Smith's website, specialized in cyber security research, programming and audit. This website also contains my personal cyber security write ups and tools.">
  <meta name="author" content="Leo Smith">

  <title>Leo Smith - DWM Fibonnaci patch</title>

  <!-- Bootstrap core CSS -->
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this theme -->
  <link href="../vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

  <!-- Theme CSS -->
  <link href="../css/freelancer.css" rel="stylesheet">
  <link href="../css/blog-post.css" rel="stylesheet">
  <link rel="shortcut icon" type="image/png" href="../img/favicon.png"/>
  <!-- Custom styles for this template -->

</head>

<body id="page-top">


  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">Leo Smith</a>
      <button class="navbar-toggler navbar-toggler-right text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item mx-0 mx-lg-1">
            <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="../index.html">Home</a>
          </li>
          <li class="nav-item mx-0 mx-lg-1">
            <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="../writeups/">Write-Ups</a>
          </li>
          <li class="nav-item mx-0 mx-lg-1">
            <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="../projects/">Projects</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Content -->
  <div class="container post">

    <div class="row">

      <!-- Post Content Column -->
      <div class="col-lg-8">

        <!-- Title -->
        <h1 class="mt-4">DWM fibonnaci patch</h1>

        <!-- Author -->
        <p class="lead">
          by Leo Smith /
          <a href="https://github.com/p4p1">p4p1</a>
        </p>

        <hr>

        <!-- Date/Time -->
        <p>Created on tue. 16 April 2020</p>

        <hr>

        <!-- Preview Image -->
        <img class="img-fluid rounded" src="https://dwm.suckless.org/dwm.svg" alt="">

        <hr>

        <!-- Post Content -->
        <p class="lead">
          I have been using dwm for about a month, enjoying the Fibonacci mode and I really
          wanted to implement gaps between the windows. So by looking at the suckless page I found
          <a href="https://dwm.suckless.org/patches/ru_gaps/dwm-ru_fibonacci-6.2.diff">this patch</a>,
          the big issue I have with this patch is that if there is a single window
          on the screen the gaps are not effective on the outer borders and that's
          pretty shit. So I decided to build my own patch!
        </p>

        <p>
          To begin with I got a clean version of dwm6.2 and patched it with the
          ru-fibonacci patch... And the compilation failed:
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/compilation_error.png" />
        <p></p>
        <p>
          Looking at the gcc error I figured out that the structure mon
          was missing a variable gappx.
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/adding_gappx.png" />
        <p></p>
        <p>
          So then I run make again and it works! :) But when I run dwm the gaps
          aren't there because I forgot to set the gaps in the source code. So
          let's do that!
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/code_set_gappx.png" />
        <p></p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/no_gapps.png" />
        <p></p>
        <p>
          Now that I added the code to set the variable gappx the issue I have is
          clear in the next two images:
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/problem.png" />
        <p></p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/gapss_are_there.png" />
        <p></p>
        <p>
          So now I will work on the value of the outer gaps. In the fibonacci.c file
          there's some useful information.
          <ol>
            <li>The "if (n == 1) {" line: 8</li>
            <li>And the "resize(c, nx + mon->gappx, ny, nw - 2 * (c->bw) - mon->gappx, nh - 2 * (c->bw) - 2*mon->gappx, False);" line: 59</li>
          </ol>
          The first line is the source of my problems. It can be translated as,
          if number of lines is equal to 1, then set the size of the window to
          fill it. I don't want that. The second line shows me how the gaps are set
          when there is more than 1 window and that's the behavior I am looking for.
        </p>
        <p>
          So I start simple I first implement the gaps on the top and left side of
          the window by adding those two " + mon gappx" and then recompile:
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/addgappxxy.png" />
        <p></p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/starting_to_get_there.png" />
        <p></p>
        <p>
          I then looked at how the width and height of the window is calculated
          by the resize that I noted above and " - mon->gappx" to the height and width
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/remove_width_height.png" />
        <p></p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/border_set_but_broken.png" />
        <p></p>
        <p>
          I'm starting to get there, at that moment I knew I was really close to
          the end of my little project! Looking back at that resize line I realized
          that they don't just remove the size of gappx to the width and height but
          that they double it before removing it, so I did exactly the same and TADAAA! it works :D
        </p>
        <img class="img-fluid rounded" src="img/dwm_fib_post/final.png" />
        <p></p>
        <p>
          Thank you so much for reading this is my first post and my first blog.
          Please follow me on GitHub and this blog so you can be update on my
          new projects.
        </p>

        <hr>


      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-4">

        <!-- Dark mode Widget -->
        <div class="card my-4">
          <h5 class="card-header">Dark Mode</h5>
          <div class="card-body">
            <label class="switch">
              <input type="checkbox" id="toggleshade" onclick="shade();shade2();">
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        <!-- Categories Widget -->
        <div class="card my-4">
          <h5 class="card-header">Useful links</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="https://gist.github.com/p4p1/9091635c66e621967092e3e1ff8e7f8c">github source code</a>
                  </li>
                  <li>
                    <a href="https://suckless.org/">suckless website</a>
                  </li>
                  <li>
                    <a href="https://dwm.suckless.org/patches/ru_gaps/dwm-ru_fibonacci-6.2.diff">patch this is based on</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <!-- Share widget -->
        <div class="card my-4">
          <h5 class="card-header">Share</h5>
          <div class="card-body">
            <!-- AddToAny BEGIN -->
            <div class="a2a_kit a2a_kit_size_32 a2a_default_style center">
              <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
              <a class="a2a_button_google_gmail"></a>
              <a class="a2a_button_facebook"></a>
              <a class="a2a_button_twitter"></a>
              <a class="a2a_button_reddit"></a>
            </div>
            <script async src="https://static.addtoany.com/menu/page.js"></script>
            <!-- AddToAny END -->
          </div>
        </div>
        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Similar content</h5>
          <div class="card-body">
            <a href="xvwm.html">xvwm.sh</a>
          </div>
        </div>
      </div>

    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="footer text-center">
    <div class="container">
      <div class="row">

        <div class="col-lg-4 mb-5 mb-lg-0">
          <h4 class="text-uppercase mb-4">Share</h4>
          <!-- AddToAny BEGIN -->
          <div class="a2a_kit a2a_kit_size_32 a2a_default_style center">
            <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
            <a class="a2a_button_google_gmail"></a>
            <a class="a2a_button_facebook"></a>
            <a class="a2a_button_twitter"></a>
            <a class="a2a_button_reddit"></a>
          </div>
          <script async src="https://static.addtoany.com/menu/page.js"></script>
          <!-- AddToAny END -->
        </div>

        <div class="col-lg-4 mb-5 mb-lg-0">
          <h4 class="text-uppercase mb-4">About this page</h4>
          <p class="lead mb-0">Template found <a target="_blank" rel="noopener noreferrer" href="https://startbootstrap.com/themes/freelancer/">here</a>.</p>
        </div>

        <div class="col-lg-4 mb-5 mb-lg-0">
          <h4 class="text-uppercase mb-4">Follow me</h4>
          <a class="btn btn-outline-light btn-social mx-1" href="https://www.linkedin.com/in/leo-smith-1bab2a156/">
            <i class="fab fa-fw fa-linkedin-in"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="https://github.com/p4p1">
            <i class="fab fa-github"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="https://linuxsecurity.expert/p/leo-smith">
              <i class="fab fa-linux"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="https://tryhackme.com/p/p4p1">
              <i class="fas fa-flag-checkered"></i>
          </a>
        </div>

      </div>
    </div>
  </footer>
  <!-- Copyright Section-->
  <section class="copyright py-4 text-center text-white">
    <div class="container"><small>Copyright © Leo Smith 2020</small></div>
  </section>
  <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
  <div class="scroll-to-top d-lg-none position-fixed ">
    <a class="js-scroll-trigger d-block text-center text-white rounded" href="#page-top">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>

  <!-- Bootstrap core JavaScript -->
  <script src="../vendor/jquery/jquery.min.js"></script>
  <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Contact Form JavaScript -->
  <script src="../js/jqBootstrapValidation.js"></script>
  <script src="../js/contact_me.js"></script>

  <!-- Custom scripts for this template -->
  <script src="../js/freelancer.min.js"></script>
  <script src="../js/hidden.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163484307-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-163484307-1');
  </script>
  <script>
    var card = document.getElementsByClassName("card");
    var h4Elements = document.getElementsByTagName("h4");
    var dark2=getDarkcookie();
    document.addEventListener('keypress', logKey2);
    if (dark2 == 1) {
      for (var i = 0; i < card.length; i++) {
        card[i].style.backgroundColor = "#423d3d";
      }
    }
    function logKey2(e) {
      if (e.key === 'b') {
        if (dark2 == 0) {
          document.getElementById("toggleshade").checked = true;
          document.cookie = "dark=1";
          for (var i = 0; i < card.length; i++) {
            card[i].style.backgroundColor = "#423d3d";
          }
          for(var i = 0; i < h4Elements.length; i++) {
               h4Elements[i].style.color = "#fff";
          }
          dark2 = 1;
        } else {
          document.getElementById("toggleshade").checked = false;
          document.cookie = "dark=0";
          document.body.style.color = "#000"
          for (var i = 0; i < card.length; i++) {
            card[i].style.backgroundColor = "#FFF";
          }
          for(var i = 0; i < h4Elements.length; i++) {
               h4Elements[i].style.color = "#fff";
          }
          dark2 = 0;
        }
      }
    }
    function shade2() {
      if (dark2 == 0) {
        document.getElementById("toggleshade").checked = true;
        document.cookie = "dark=1";
        for (var i = 0; i < card.length; i++) {
          card[i].style.backgroundColor = "#423d3d";
        }
        for(var i = 0; i < h4Elements.length; i++) {
             h4Elements[i].style.color = "#fff";
        }
        dark2 = 1;
      } else {
        document.getElementById("toggleshade").checked = false;
        document.cookie = "dark=0";
        document.body.style.color = "#000"
        for (var i = 0; i < card.length; i++) {
          card[i].style.backgroundColor = "#FFF";
        }
        for(var i = 0; i < h4Elements.length; i++) {
             h4Elements[i].style.color = "#fff";
        }
        dark2 = 0;
      }
    }
  </script>

</body>

</html>
